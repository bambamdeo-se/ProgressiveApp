function AddFuelRow(n){var i=n.target,t=n.target.parentElement.parentElement.attributes[0].value;ValidateJurisdictionBeforeAddRow(i,t).then(function(i){if(!i)return n.preventDefault(),!1;AddRowForFuel(n,t)})}function AddRowForFuel(n,t){var i=JSON.stringify({FuelList:GetFuelDetailList(n.target)}),r={fuelDetailModelList:i};return $.ajax({url:"/Trip/AddNewFuelRow",data:{tripDetailPopupInfo:i},type:"POST",success:function(i){var r,u;$("#FuelDetailTable").html(i.Object);r=n.currentTarget.name;r&&(r.match("Jurisdiction$")?$('input[name="FuelList['+t+'].UserTrxDate"]').focus():r.match("UserTrxDate$")?$('input[name="FuelList['+t+'].PurchaseQty"]').focus():r.match("PurchaseQty$")?$('input[name="FuelList['+t+'].FuelClassName"]').focus():r.match("FuelClassName$")?$('input[name="FuelList['+t+'].SiteName"]').focus():r.match("NonReceipted$")?$('input[name="FuelList['+t+'].SiteName"]').focus():r.match("SiteName$")?$('input[name="FuelList['+t+'].SiteCity"]').focus():r.match("SiteCity$")?$('input[name="FuelList['+t+'].TrxNbr"]').focus():r.match("TrxNbr$")?$('input[name="FuelList['+t+'].PurchasePrice"]').focus():r.match("PurchasePrice$")&&(u=t+1,$('input[name="FuelList['+u+'].Jurisdiction"]').focus()))},error:function(){}}),!1}function DeleteFuel(n,t){var i=JSON.stringify({RowNo:t,fuelList:GetFuelDetailList(n)});return $.ajax({url:"/Trip/DeleteFuelDetail",data:{tripDetailPopupInfo:i},type:"POST",success:function(n){$("#FuelDetailTable").html(n.Object)},error:function(){}}),!1}function GetListOfFuelDetail(){var i=[],u=$("#_NewTrip #Unit").val(),n=$("table#FuelTable").clone(),r,t;for($(n).find("input").each(function(){$(this).attr("value",$(this).val())}),$(n).find('input[type="checkbox"]').each(function(){$(this).is(":checked")?($(this).attr("checked","checked"),$(this).val(!0)):($(this).removeAttr("checked"),$(this).val(!1))}),r=n.find("tbody#FuelData tr").length,t=0;t<r;t++)i.push({StateProvince:n.find('tbody#FuelData input[name="FuelList['+t+'].Jurisdiction"]').val(),StateProvinceId:n.find('tbody#FuelData input[name="FuelList['+t+'].JurisdictionId"]').val(),TrxDate:n.find('tbody#FuelData input[name="FuelList['+t+'].TrxDate"]').val(),PurchaseQty:n.find('tbody#FuelData input[name="FuelList['+t+'].PurchaseQty"]').val(),FuelClassName:n.find('tbody#FuelData input[name="FuelList['+t+'].FuelClassName"]').val(),FuelClassId:n.find('tbody#FuelData input[name="FuelList['+t+'].FuelClassId"]').val(),SiteName:n.find('tbody#FuelData input[name="FuelList['+t+'].SiteName"]').val(),SiteCity:n.find('tbody#FuelData input[name="FuelList['+t+'].SiteCity"]').val(),TrxNbr:n.find('tbody#FuelData input[name="FuelList['+t+'].TrxNbr"]').val(),PurchasePrice:n.find('tbody#FuelData input[name="FuelList['+t+'].PurchasePrice"]').val(),UnitId:u});return i}function GetFuelDetailList(n){var r=[],f=$("#_NewTrip #Unit").val(),t=$(n).parents("table").clone(),u,i;for($(t).find("input").each(function(){$(this).attr("value",$(this).val())}),$(t).find('input[type="checkbox"]').each(function(){$(this).is(":checked")?($(this).attr("checked","checked"),$(this).val(!0)):($(this).removeAttr("checked"),$(this).val(!1))}),u=t.find("tbody#FuelData tr").length,i=0;i<u;i++)r.push({StateProvince:t.find('tbody#FuelData input[name="FuelList['+i+'].Jurisdiction"]').val(),StateProvinceId:t.find('tbody#FuelData input[name="FuelList['+i+'].JurisdictionId"]').val(),TrxDate:t.find('tbody#FuelData input[name="FuelList['+i+'].TrxDate"]').val(),PurchaseQty:t.find('tbody#FuelData input[name="FuelList['+i+'].PurchaseQty"]').val(),FuelClassName:t.find('tbody#FuelData input[name="FuelList['+i+'].FuelClassName"]').val(),FuelClassId:t.find('tbody#FuelData input[name="FuelList['+i+'].FuelClassId"]').val(),SiteName:t.find('tbody#FuelData input[name="FuelList['+i+'].SiteName"]').val(),SiteCity:t.find('tbody#FuelData input[name="FuelList['+i+'].SiteCity"]').val(),TrxNbr:t.find('tbody#FuelData input[name="FuelList['+i+'].TrxNbr"]').val(),PurchasePrice:t.find('tbody#FuelData input[name="FuelList['+i+'].PurchasePrice"]').val(),UnitId:f});return r}function ClearFuelCurrentRow(n,t){$('tbody#FuelData input[name="FuelList['+t+'].Jurisdiction"]').val("");$('tbody#FuelData input[name="FuelList['+t+'].JurisdictionId"]').val("");$("tbody#FuelData span[id='FuelList["+t+"].Jurisdiction']").html("");$('tbody#FuelData input[name="FuelList['+t+'].UserTrxDate"]').val("");$("tbody#FuelData span[id='FuelList["+t+"].UserTrxDate']").html("");$('tbody#FuelData input[name="FuelList['+t+'].TrxDate"]').val("");$('tbody#FuelData input[name="FuelList['+t+'].PurchaseQty"]').val("");$("tbody#FuelData span[id='FuelList["+t+"].PurchaseQty']").html("");$('tbody#FuelData input[name="FuelList['+t+'].FuelClassName"]').val("");$("tbody#FuelData span[id='FuelList["+t+"].FuelClassName']").html("");$('tbody#FuelData input[name="FuelList['+t+'].FuelClassId"]').val("");$('tbody#FuelData input[name="FuelList['+t+'].SiteName"]').val("");$('tbody#FuelData input[name="FuelList['+t+'].SiteCity"]').val("");$('tbody#FuelData input[name="FuelList['+t+'].TrxNbr"]').val("");$('tbody#FuelData input[name="FuelList['+t+'].PurchasePrice"]').val("");$("tbody#FuelData span[id='FuelList["+t+"].PurchasePrice']").html("")}function VerifyTrxDate(n,t){var i=n.value,e,o,r,u,f,s,h;if(i==="")return $("tbody#FuelData span[id='FuelList["+t+"].UserTrxDate']").html("Transaction date is must"),$("tbody#FuelData input[name='FuelList["+t+"].TrxDate']").val(""),n.focus(),!1;if(i.length>8&&i.includes("/")&&(e=i.split("/"),i=e[0]+e[1]+e[2]),i.length==4||i.length==6||i.length==8)if(o=new Date,i.length==4&&(r=i.substring(2,4),u=i.substring(0,2),f=o.getFullYear()),i.length==6&&(r=i.substring(2,4),u=i.substring(0,2),f="20"+i.substring(4,6)),i.length==8&&(r=i.substring(2,4),u=i.substring(0,2),f=i.substring(4,8)),isNaN(r)&&isNaN(u)&&isNaN(f))$("tbody#FuelData span[id='FuelList["+t+"].UserTrxDate']").html("Invalid Format"),$("tbody#FuelData input[name='FuelList["+t+"].TrxDate']").val(""),n.value="",n.focus(),flag=1;else if(s=u+""+r+""+f,isNaN(s))$("tbody#FuelData input[name='FuelList["+t+"].TrxDate']").val(""),$("tbody#FuelData span[id='FuelList["+t+"].UserTrxDate']").html("Invalid Format"),n.value="",n.focus(),flag=1;else if(r>31||u>12)$("tbody#FuelData input[name='FuelList["+t+"].TrxDate']").val(""),$("tbody#FuelData span[id='FuelList["+t+"].UserTrxDate']").html("Invalid Format"),n.value="",n.focus(),flag=1;else if(r<=0||u<=0)$("tbody#FuelData input[name='FuelList["+t+"].TrxDate']").val(""),$("tbody#FuelData span[id='FuelList["+t+"].UserTrxDate']").html("Invalid Format"),n.value="",n.focus();else{if(h=hasFutureDate(u,r,f),h)return $("tbody#FuelData input[name='FuelList["+t+"].TrxDate']").val(""),$("tbody#FuelData span[id='FuelList["+t+"].UserTrxDate']").html("Can't be future date"),n.value="",n.focus(),!1;n.value=u+"/"+r+"/"+f;$("tbody#FuelData input[name='FuelList["+t+"].TrxDate']").val(u+"/"+r+"/"+f);$("tbody#FuelData span[id='FuelList["+t+"].UserTrxDate']").html("")}else $("tbody#FuelData span[id='FuelList["+t+"].UserTrxDate']").html("Invalid Format"),$("tbody#FuelData input[name='FuelList["+t+"].TrxDate']").val(u+"/"+r+"/"+f),n.value="",n.focus()}function CheckQuantity(n,t){var i=n.value;if(i==="")return $("tbody#FuelData span[id='FuelList["+t+"].PurchaseQty']").html("*Required"),$("tbody#FuelData span#FuelList["+t+"].PurchaseQty").val("* Required"),n.focus(),!1;if(isNaN(i)||(i=parseFloat(parseFloat(i).toFixed(3)),i<0))return $("tbody#FuelData span[id='FuelList["+t+"].PurchaseQty']").html("Positive Numbers only"),$("tbody#FuelData input[name='FuelList["+t+"].PurchaseQty']").val(""),n.value="",n.focus(),!1;n.value=i;$("tbody#FuelData span[id='FuelList["+t+"].PurchaseQty']").html("")}function CheckPrice(n,t){var i=n.value;if(i===""){$("tbody#FuelData span[id='FuelList["+t+"].PurchasePrice']").html("");return}if(isNaN(i))return $("tbody#FuelData span[id='FuelList["+t+"].PurchasePrice']").html("Positive Numbers only"),$("tbody#FuelData input[name='FuelList["+t+"].PurchasePrice']").val(""),n.value="",n.focus(),!1;if(i=parseFloat(parseFloat(i).toFixed(2)),i<0)return $("tbody#FuelData input[name='FuelList["+t+"].PurchasePrice']").val(""),$("tbody#FuelData span[id='FuelList["+t+"].PurchasePrice']").html("Positive Numbers only"),n.value="",n.focus(),!1;n.value=i;$("tbody#FuelData span[id='FuelList["+t+"].PurchasePrice']").html("")}function CheckFuelClass(n){var t=n.value;$("#FuelClassList option").filter(function(){var n=this.value;return n===t}).length&&alert(n.value)}function ValidateFuelClass(n,t){var r=n.value,i;return n.val==""?($("tbody#FuelData input[name='FuelList["+t+"].FuelClassName']").val(""),$("tbody#FuelData input[name='FuelList["+t+"].FuelClassId']").val(""),$("tbody#FuelData span[id='FuelList["+t+"].FuelClassName']").html("*Required"),n.value="",n.focus(),!1):(i="",$.ajax({url:"/Trip/ValidFuelClass",data:{fuelClassCode:r},type:"POST",success:function(u){if(u.Success)i=u.FuelClassId,$("tbody#FuelData input[name='FuelList["+t+"].FuelClassName']").val(r.toUpperCase()),$("tbody#FuelData input[name='FuelList["+t+"].FuelClassId']").val(i),$("tbody#FuelData span[id='FuelList["+t+"].FuelClassName']").html("");else return $("tbody#FuelData input[name='FuelList["+t+"].FuelClassName']").val(""),$("tbody#FuelData input[name='FuelList["+t+"].FuelClassId']").val(""),$("tbody#FuelData span[id='FuelList["+t+"].FuelClassName']").html("Enter valid fuel type"),n.value="",n.focus(),!1},error:function(){return $("tbody#FuelData input[name='FuelList["+t+"].FuelClassName']").val(""),$("tbody#FuelData input[name='FuelList["+t+"].FuelClassId']").val(""),$("tbody#FuelData span[id='FuelList["+t+"].FuelClassName']").html("Enter valid fuel type"),n.value="",n.focus(),!1}}),!1)}function ValidateJurisdiction(n,t){var r=n.value,i;return n.val==""?($("tbody#FuelData input[name='FuelList["+t+"].Jurisdiction']").val(""),$("tbody#FuelData input[name='FuelList["+t+"].JurisdictionId']").val(""),$("tbody#FuelData span[id='FuelList["+t+"].Jurisdiction']").html("* Required"),n.value="",n.focus(),!1):(i="",$.ajax({url:"/Trip/ValidJurisdiction",data:{JurisdictionCode:r},type:"POST",success:function(u){if(u.Success)i=u.JurisdictionId,$("tbody#FuelData input[name='FuelList["+t+"].Jurisdiction']").val(r.toUpperCase()),$("tbody#FuelData input[name='FuelList["+t+"].JurisdictionId']").val(i),$("tbody#FuelData span[id='FuelList["+t+"].Jurisdiction']").html("Enter valid Jurisdiction");else return $("tbody#FuelData input[name='FuelList["+t+"].Jurisdiction']").val(""),$("tbody#FuelData input[name='FuelList["+t+"].JurisdictionId']").val(""),$("tbody#FuelData span[id='FuelList["+t+"].Jurisdiction']").html("Enter valid Jurisdiction"),n.value="",n.focus(),!1},error:function(){return $("tbody#FuelData input[name='FuelList["+t+"].Jurisdiction']").val(""),$("tbody#FuelData input[name='FuelList["+t+"].JurisdictionId']").val(""),$("tbody#FuelData span#FuelList["+t+"].Jurisdiction").val("Enter valid Jurisdiction"),$("tbody#FuelData span[id='FuelList["+t+"].Jurisdiction']").html("Enter valid Jurisdiction"),n.value="",n.focus(),!1}}),!1)}function ValidateJurisdictionBeforeAddRow(n,t){var i=jQuery.Deferred(),u=n.value,r;return n.val==""&&($("tbody#FuelData input[name='FuelList["+t+"].Jurisdiction']").val(""),$("tbody#FuelData input[name='FuelList["+t+"].JurisdictionId']").val(""),$("tbody#FuelData span[id='FuelList["+t+"].Jurisdiction']").html("Required"),n.value="",n.focus(),i.resolve(!1)),r="",$.ajax({url:"/Trip/ValidJurisdiction",data:{JurisdictionCode:u},type:"POST",success:function(f){f.Success?(r=f.JurisdictionId,$("tbody#FuelData input[name='FuelList["+t+"].Jurisdiction']").val(u.toUpperCase()),$("tbody#FuelData input[name='FuelList["+t+"].JurisdictionId']").val(r),$("tbody#FuelData span[id='FuelList["+t+"].Jurisdiction']").html(""),i.resolve(!0)):($("tbody#FuelData input[name='FuelList["+t+"].Jurisdiction']").val(""),$("tbody#FuelData input[name='FuelList["+t+"].JurisdictionId']").val(""),$("tbody#FuelData span[id='FuelList["+t+"].Jurisdiction']").html("Enter valid Jurisdiction"),n.value="",n.focus(),i.resolve(!1))},error:function(){$("tbody#FuelData input[name='FuelList["+t+"].Jurisdiction']").val("");$("tbody#FuelData input[name='FuelList["+t+"].JurisdictionId']").val("");$("tbody#FuelData span[id='FuelList["+t+"].Jurisdiction']").html("Enter valid Jurisdiction");n.value="";n.focus();i.resolve(!1)}}),i.promise()}